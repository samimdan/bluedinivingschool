{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import {\n  elementScroll,\n  observeElementOffset,\n  observeElementRect,\n  observeWindowOffset,\n  observeWindowRect,\n  PartialKeys,\n  Virtualizer,\n  VirtualizerOptions,\n  windowScroll,\n} from '@tanstack/virtual-core'\nimport {\n  computed,\n  onScopeDispose,\n  Ref,\n  shallowRef,\n  triggerRef,\n  unref,\n  watch,\n} from 'vue'\n\ntype MaybeRef<T> = T | Ref<T>\n\nfunction useVirtualizerBase<\n  TScrollElement extends Element | Window,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<VirtualizerOptions<TScrollElement, TItemElement>>,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  const virtualizer = new Virtualizer(unref(options))\n  const state = shallowRef(virtualizer)\n\n  const cleanup = virtualizer._didMount()\n\n  watch(\n    () => unref(options).getScrollElement(),\n    (el) => {\n      if (el) {\n        virtualizer._willUpdate()\n      }\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  watch(\n    () => unref(options),\n    (options) => {\n      virtualizer.setOptions({\n        ...options,\n        onChange: (instance) => {\n          triggerRef(state)\n          options.onChange?.(instance)\n        },\n      })\n\n      virtualizer._willUpdate()\n      triggerRef(state)\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  onScopeDispose(cleanup)\n\n  return state\n}\n\nexport function useVirtualizer<\n  TScrollElement extends Element,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<TScrollElement, TItemElement>,\n      'observeElementRect' | 'observeElementOffset' | 'scrollToFn'\n    >\n  >,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  return useVirtualizerBase<TScrollElement, TItemElement>(\n    computed(() => ({\n      observeElementRect: observeElementRect,\n      observeElementOffset: observeElementOffset,\n      scrollToFn: elementScroll,\n      ...unref(options),\n    })),\n  )\n}\n\nexport function useWindowVirtualizer<TItemElement extends Element>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<Window, TItemElement>,\n      | 'observeElementRect'\n      | 'observeElementOffset'\n      | 'scrollToFn'\n      | 'getScrollElement'\n    >\n  >,\n): Ref<Virtualizer<Window, TItemElement>> {\n  return useVirtualizerBase<Window, TItemElement>(\n    computed(() => ({\n      getScrollElement: () => (typeof document !== 'undefined' ? window : null),\n      observeElementRect: observeWindowRect,\n      observeElementOffset: observeWindowOffset,\n      scrollToFn: windowScroll,\n      ...unref(options),\n    })),\n  )\n}\n"],"names":["useVirtualizerBase","options","virtualizer","Virtualizer","unref","state","shallowRef","cleanup","_didMount","watch","getScrollElement","el","_willUpdate","immediate","setOptions","_extends","onChange","instance","triggerRef","onScopeDispose","useVirtualizer","computed","observeElementRect","observeElementOffset","scrollToFn","elementScroll","useWindowVirtualizer","document","window","observeWindowRect","observeWindowOffset","windowScroll"],"mappings":";;;;;;;;;;;;;;;;;;AAuBA,SAASA,kBAAkB,CAIzBC,OAAmE,EACnB;EAChD,IAAMC,WAAW,GAAG,IAAIC,uBAAW,CAACC,SAAK,CAACH,OAAO,CAAC,CAAC,CAAA;AACnD,EAAA,IAAMI,KAAK,GAAGC,cAAU,CAACJ,WAAW,CAAC,CAAA;AAErC,EAAA,IAAMK,OAAO,GAAGL,WAAW,CAACM,SAAS,EAAE,CAAA;AAEvCC,EAAAA,SAAK,CACH,YAAA;AAAA,IAAA,OAAML,SAAK,CAACH,OAAO,CAAC,CAACS,gBAAgB,EAAE,CAAA;GACvC,EAAA,UAACC,EAAE,EAAK;AACN,IAAA,IAAIA,EAAE,EAAE;MACNT,WAAW,CAACU,WAAW,EAAE,CAAA;AAC3B,KAAA;AACF,GAAC,EACD;AACEC,IAAAA,SAAS,EAAE,IAAA;AACb,GAAC,CACF,CAAA;AAEDJ,EAAAA,SAAK,CACH,YAAA;IAAA,OAAML,SAAK,CAACH,OAAO,CAAC,CAAA;GACpB,EAAA,UAACA,OAAO,EAAK;IACXC,WAAW,CAACY,UAAU,CAAAC,oCAAA,CAAA,EAAA,EACjBd,OAAO,EAAA;MACVe,QAAQ,EAAE,SAACC,QAAAA,CAAAA,QAAQ,EAAK;QACtBC,cAAU,CAACb,KAAK,CAAC,CAAA;QACjBJ,OAAO,CAACe,QAAQ,IAAhBf,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,OAAO,CAACe,QAAQ,CAAGC,QAAQ,CAAC,CAAA;AAC9B,OAAA;KACA,CAAA,CAAA,CAAA;IAEFf,WAAW,CAACU,WAAW,EAAE,CAAA;IACzBM,cAAU,CAACb,KAAK,CAAC,CAAA;AACnB,GAAC,EACD;AACEQ,IAAAA,SAAS,EAAE,IAAA;AACb,GAAC,CACF,CAAA;EAEDM,kBAAc,CAACZ,OAAO,CAAC,CAAA;AAEvB,EAAA,OAAOF,KAAK,CAAA;AACd,CAAA;AAEO,SAASe,cAAc,CAI5BnB,OAKC,EAC+C;EAChD,OAAOD,kBAAkB,CACvBqB,YAAQ,CAAC,YAAA;AAAA,IAAA,OAAAN,oCAAA,CAAA;AACPO,MAAAA,kBAAkB,EAAEA,8BAAkB;AACtCC,MAAAA,oBAAoB,EAAEA,gCAAoB;AAC1CC,MAAAA,UAAU,EAAEC,yBAAAA;KACTrB,EAAAA,SAAK,CAACH,OAAO,CAAC,CAAA,CAAA;AAAA,GACjB,CAAC,CACJ,CAAA;AACH,CAAA;AAEO,SAASyB,oBAAoB,CAClCzB,OAQC,EACuC;EACxC,OAAOD,kBAAkB,CACvBqB,YAAQ,CAAC,YAAA;AAAA,IAAA,OAAAN,oCAAA,CAAA;AACPL,MAAAA,gBAAgB,EAAE,SAAA,gBAAA,GAAA;AAAA,QAAA,OAAO,OAAOiB,QAAQ,KAAK,WAAW,GAAGC,MAAM,GAAG,IAAI,CAAA;OAAC;AACzEN,MAAAA,kBAAkB,EAAEO,6BAAiB;AACrCN,MAAAA,oBAAoB,EAAEO,+BAAmB;AACzCN,MAAAA,UAAU,EAAEO,wBAAAA;KACT3B,EAAAA,SAAK,CAACH,OAAO,CAAC,CAAA,CAAA;AAAA,GACjB,CAAC,CACJ,CAAA;AACH;;;;;"}