{"version":3,"file":"index.development.js","sources":["../../src/index.ts"],"sourcesContent":["import {\n  elementScroll,\n  observeElementOffset,\n  observeElementRect,\n  observeWindowOffset,\n  observeWindowRect,\n  PartialKeys,\n  Virtualizer,\n  VirtualizerOptions,\n  windowScroll,\n} from '@tanstack/virtual-core'\nimport {\n  computed,\n  onScopeDispose,\n  Ref,\n  shallowRef,\n  triggerRef,\n  unref,\n  watch,\n} from 'vue'\n\ntype MaybeRef<T> = T | Ref<T>\n\nfunction useVirtualizerBase<\n  TScrollElement extends Element | Window,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<VirtualizerOptions<TScrollElement, TItemElement>>,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  const virtualizer = new Virtualizer(unref(options))\n  const state = shallowRef(virtualizer)\n\n  const cleanup = virtualizer._didMount()\n\n  watch(\n    () => unref(options).getScrollElement(),\n    (el) => {\n      if (el) {\n        virtualizer._willUpdate()\n      }\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  watch(\n    () => unref(options),\n    (options) => {\n      virtualizer.setOptions({\n        ...options,\n        onChange: (instance) => {\n          triggerRef(state)\n          options.onChange?.(instance)\n        },\n      })\n\n      virtualizer._willUpdate()\n      triggerRef(state)\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  onScopeDispose(cleanup)\n\n  return state\n}\n\nexport function useVirtualizer<\n  TScrollElement extends Element,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<TScrollElement, TItemElement>,\n      'observeElementRect' | 'observeElementOffset' | 'scrollToFn'\n    >\n  >,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  return useVirtualizerBase<TScrollElement, TItemElement>(\n    computed(() => ({\n      observeElementRect: observeElementRect,\n      observeElementOffset: observeElementOffset,\n      scrollToFn: elementScroll,\n      ...unref(options),\n    })),\n  )\n}\n\nexport function useWindowVirtualizer<TItemElement extends Element>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<Window, TItemElement>,\n      | 'observeElementRect'\n      | 'observeElementOffset'\n      | 'scrollToFn'\n      | 'getScrollElement'\n    >\n  >,\n): Ref<Virtualizer<Window, TItemElement>> {\n  return useVirtualizerBase<Window, TItemElement>(\n    computed(() => ({\n      getScrollElement: () => (typeof document !== 'undefined' ? window : null),\n      observeElementRect: observeWindowRect,\n      observeElementOffset: observeWindowOffset,\n      scrollToFn: windowScroll,\n      ...unref(options),\n    })),\n  )\n}\n"],"names":["useVirtualizerBase","options","virtualizer","Virtualizer","unref","state","shallowRef","cleanup","_didMount","watch","getScrollElement","el","_willUpdate","immediate","setOptions","onChange","instance","triggerRef","onScopeDispose","useVirtualizer","computed","observeElementRect","observeElementOffset","scrollToFn","elementScroll","useWindowVirtualizer","document","window","observeWindowRect","observeWindowOffset","windowScroll"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAuBA,SAASA,kBAAkB,CAIzBC,OAAmE,EACnB;IAChD,IAAMC,WAAW,GAAG,IAAIC,uBAAW,CAACC,SAAK,CAACH,OAAO,CAAC,CAAC,CAAA;EACnD,EAAA,IAAMI,KAAK,GAAGC,cAAU,CAACJ,WAAW,CAAC,CAAA;EAErC,EAAA,IAAMK,OAAO,GAAGL,WAAW,CAACM,SAAS,EAAE,CAAA;EAEvCC,EAAAA,SAAK,CACH,YAAA;EAAA,IAAA,OAAML,SAAK,CAACH,OAAO,CAAC,CAACS,gBAAgB,EAAE,CAAA;KACvC,EAAA,UAACC,EAAE,EAAK;EACN,IAAA,IAAIA,EAAE,EAAE;QACNT,WAAW,CAACU,WAAW,EAAE,CAAA;EAC3B,KAAA;EACF,GAAC,EACD;EACEC,IAAAA,SAAS,EAAE,IAAA;EACb,GAAC,CACF,CAAA;EAEDJ,EAAAA,SAAK,CACH,YAAA;MAAA,OAAML,SAAK,CAACH,OAAO,CAAC,CAAA;KACpB,EAAA,UAACA,OAAO,EAAK;MACXC,WAAW,CAACY,UAAU,CAAA,QAAA,CAAA,EAAA,EACjBb,OAAO,EAAA;QACVc,QAAQ,EAAE,SAACC,QAAAA,CAAAA,QAAQ,EAAK;UACtBC,cAAU,CAACZ,KAAK,CAAC,CAAA;UACjBJ,OAAO,CAACc,QAAQ,IAAhBd,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,OAAO,CAACc,QAAQ,CAAGC,QAAQ,CAAC,CAAA;EAC9B,OAAA;OACA,CAAA,CAAA,CAAA;MAEFd,WAAW,CAACU,WAAW,EAAE,CAAA;MACzBK,cAAU,CAACZ,KAAK,CAAC,CAAA;EACnB,GAAC,EACD;EACEQ,IAAAA,SAAS,EAAE,IAAA;EACb,GAAC,CACF,CAAA;IAEDK,kBAAc,CAACX,OAAO,CAAC,CAAA;EAEvB,EAAA,OAAOF,KAAK,CAAA;EACd,CAAA;EAEO,SAASc,cAAc,CAI5BlB,OAKC,EAC+C;IAChD,OAAOD,kBAAkB,CACvBoB,YAAQ,CAAC,YAAA;EAAA,IAAA,OAAA,QAAA,CAAA;EACPC,MAAAA,kBAAkB,EAAEA,8BAAkB;EACtCC,MAAAA,oBAAoB,EAAEA,gCAAoB;EAC1CC,MAAAA,UAAU,EAAEC,yBAAAA;OACTpB,EAAAA,SAAK,CAACH,OAAO,CAAC,CAAA,CAAA;EAAA,GACjB,CAAC,CACJ,CAAA;EACH,CAAA;EAEO,SAASwB,oBAAoB,CAClCxB,OAQC,EACuC;IACxC,OAAOD,kBAAkB,CACvBoB,YAAQ,CAAC,YAAA;EAAA,IAAA,OAAA,QAAA,CAAA;EACPV,MAAAA,gBAAgB,EAAE,SAAA,gBAAA,GAAA;EAAA,QAAA,OAAO,OAAOgB,QAAQ,KAAK,WAAW,GAAGC,MAAM,GAAG,IAAI,CAAA;SAAC;EACzEN,MAAAA,kBAAkB,EAAEO,6BAAiB;EACrCN,MAAAA,oBAAoB,EAAEO,+BAAmB;EACzCN,MAAAA,UAAU,EAAEO,wBAAAA;OACT1B,EAAAA,SAAK,CAACH,OAAO,CAAC,CAAA,CAAA;EAAA,GACjB,CAAC,CACJ,CAAA;EACH;;;;;;;;;;;"}